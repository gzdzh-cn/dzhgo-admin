import{v as e}from"./@vue.runtime-dom-0c977c95.js";import{i as l}from"./index.umd.min-b68308bb.js";import{u as a}from"./index-c06e60a9.js";import"./vue-echarts-11c03c89.js";import{a as o}from"./element-plus-961823fe.js";import"./store-52839c99.js";import"./index-4d43d044.js";import{a9 as t,aa as r,ab as s,M as n}from"./@element-plus.icons-vue-15072d5d.js";import{d as p}from"./dayjs-89173748.js";import{f as u,h as i,a5 as m,o as d,V as c,W as v,g as b,_,a as f,Z as g,c as y,a3 as h,F as w,C as j,a9 as k,X as x}from"./@vue.runtime-core-dd57a9c9.js";import{r as V,h as C,M as T}from"./@vue.reactivity-9aee8bf6.js";import{ak as F}from"./@vue.shared-dddd31b8.js";import{_ as U}from"./subTrack.vue_vue_type_script_name_customeer_pro-subTrack_setup_true_lang-7888d976.js";import{_ as I}from"./vue-qr-c4264fa6.js";import"./array.prototype.flat-eee42aa4.js";import"./define-properties-b1343066.js";import"./object-keys-e5f060db.js";import"./has-property-descriptors-6845433e.js";import"./get-intrinsic-cff09dfa.js";import"./has-symbols-a48c7173.js";import"./function-bind-cd5d7d08.js";import"./has-3a5c7287.js";import"./call-bind-cfba7623.js";import"./es-abstract-253c30b8.js";import"./has-proto-93b28181.js";import"./gopd-1516b43e.js";import"./is-regex-74a42cfc.js";import"./has-tostringtag-ad4fd641.js";import"./is-callable-99eeba16.js";import"./object-inspect-66cad57c.js";import"./es-to-primitive-6664914a.js";import"./is-date-object-d2231eea.js";import"./is-symbol-3a29a1ce.js";import"./safe-regex-test-183ad494.js";import"./es-shim-unscopables-89146e87.js";import"./vue-6d1d317a.js";import"./vue-router-17136280.js";import"./monaco-editor-c28fb00f.js";import"./axios-6b2fb661.js";import"./nprogress-64657d8f.js";import"./lodash-es-8394daf0.js";import"./@vueuse.core-3c960f69.js";import"./@vueuse.shared-2b88397c.js";import"./pinia-efddbf44.js";import"./vue-demi-71ba0ef2.js";import"./mockjs-0b3ee9ca.js";import"./merge-4bdec194.js";import"./mitt-2d52b530.js";import"./clone-deep-53153407.js";import"./shallow-clone-d419fbda.js";import"./kind-of-d78bf752.js";import"./is-plain-object-40c8282f.js";import"./isobject-c886ab54.js";import"./resize-detector-2312ef2b.js";import"./echarts-e550b62f.js";import"./tslib-a4e99503.js";import"./zrender-f72fb7be.js";import"./@ctrl.tinycolor-d9b9bf03.js";import"./@popperjs.core-b696b006.js";import"./async-validator-ff95bfc9.js";import"./memoize-one-63ab667a.js";import"./escape-html-1935ddb3.js";import"./normalize-wheel-es-3222b0a2.js";import"./@floating-ui.dom-92665be4.js";import"./@floating-ui.core-c1b3624a.js";import"./js-binary-schema-parser-814ef804.js";const Y={style:{"min-height":"100px",height:"400px"}},D={style:{height:"110px"}},M={style:{"min-height":"100px",height:"400px",overflow:"auto"}},H={style:{"min-height":"100px"}},q={style:{}},O={style:{"font-weight":"400"}},R={style:{"font-weight":"200"}},L={style:{"font-weight":"200"}},S={style:{"min-height":"100px",height:"500px",overflow:"auto"}},N={style:{}},P=["src"],z={key:1,style:{"font-weight":"400"}},A=["innerHTML"],W={style:{"font-weight":"200"}},G=u({name:"customeer_pro-subFollow"}),E=u({...G,props:{id:String,status:Number},emits:["cancel"],setup(e,{expose:n,emit:u}){const j=e,{service:k}=a(),x=V([]),U=V([]),I=new Date;function G(e){return e.getTime()<Date.now()-864e5}const E=l.useTable({columns:[{label:"姓名",prop:"name",width:250},{label:"手机号",prop:"mobile"},{label:"微信号",prop:"wechat"},{label:"来源",prop:"source_from",dict:[{label:"手动录入",value:1},{label:"百度",value:2},{label:"抖音",value:3},{label:"53客服",value:4},{label:"小红书",value:5}]}]}),$=l.useCrud({service:k.customer_pro.clues,async onRefresh(e,{render:l}){const a=await k.customer_pro.clues.list({id:e.id});k.customer_pro.clues._permission.followList&&(U.value=await k.customer_pro.clues.followList({cluesId:e.id})),k.customer_pro.clues._permission.chatContentList&&(x.value=await k.customer_pro.clues.chatContentList({cluesId:e.id})),l(a)}}),J=V("order"),X=()=>{},Z=V(),B=C({followType:[],nextFollowupTime:"",remark:""}),K=C({followType:[{required:!0,message:"选择跟进方式",trigger:"change"}],nextFollowupTime:[{required:!0,message:"选择下次跟进时间",trigger:"change"}],remark:[{required:!0,message:"填写备注",trigger:"change"}]}),Q={expandTrigger:"hover"},ee=V([{label:"电话访谈",value:"2",children:[{label:"无人接听",value:"21"},{label:"拒接",value:"22"},{label:"已接通",value:"23"}]},{label:"微信沟通",value:"3",children:[{label:"待通过",value:"31"},{label:"拒绝通过",value:"32"},{label:"已通过",value:"33"}]},{label:"视频参观",value:"4"},{label:"预约参观",value:"5"},{label:"已参观",value:"6"}]),le=e=>{},ae=e=>{const l=/\[IMG\](.*?)\[\/IMG\]/g;let a;const o=[];for(;null!==(a=l.exec(e));){const e=a[1].split("?");o.push(e[0])}return o},oe=e=>{if(e)return JSON.parse(e)};return i((()=>{var e;null==(e=$.value)||e.refresh({id:j.id})})),n({sub:async()=>{var e;Z.value&&await(null==(e=Z.value)?void 0:e.validate(((e,l)=>{e?k.customer_pro.clues.followAdd({cluesId:j.id,...B}).then((e=>{o.success("保存成功"),u("cancel")})).finally((()=>{})):o.error("错误"+l)})))},pushCommonClause:()=>{k.customer_pro.clues.pushCommonClause({cluesId:j.id}),o.success("保存成功"),u("cancel")}}),(l,a)=>{const o=m("el-divider"),n=m("cl-table"),u=m("cl-row"),i=m("cl-crud"),j=m("el-cascader"),V=m("el-form-item"),C=m("el-date-picker"),te=m("el-input"),re=m("el-form"),se=m("el-tab-pane"),ne=m("el-step"),pe=m("el-steps"),ue=m("el-tabs");return d(),c(ue,{modelValue:J.value,"onUpdate:modelValue":a[3]||(a[3]=e=>J.value=e),type:"border-card",onTabClick:X},{default:v((()=>[b(se,{label:"创建记录",name:"order"},{default:v((()=>[b(o,{"content-position":"left"},{default:v((()=>[_("基本信息")])),_:1}),f("div",Y,[f("div",D,[b(i,{ref_key:"Crud",ref:$},{default:v((()=>[b(u,null,{default:v((()=>[b(n,{ref_key:"Table",ref:E},null,512)])),_:1})])),_:1},512)]),0==e.status?(d(),c(o,{key:0,"content-position":"left"},{default:v((()=>[_("创建记录")])),_:1})):g("",!0),0==e.status&&T(k).customer_pro.clues._permission.followAdd?(d(),c(re,{key:1,style:{"margin-top":"55px"},ref_key:"formRef",ref:Z,model:B,rules:K,inline:!0,"label-width":"auto"},{default:v((()=>[b(V,{label:"跟进方式",prop:"followType",style:{width:"45%"}},{default:v((()=>[b(j,{modelValue:B.followType,"onUpdate:modelValue":a[0]||(a[0]=e=>B.followType=e),options:ee.value,onChange:le,props:Q,clearable:"",placeholder:"选择跟进方式"},null,8,["modelValue","options"])])),_:1}),b(V,{label:"下次跟进",prop:"nextFollowupTime",style:{width:"45%"}},{default:v((()=>[b(C,{modelValue:B.nextFollowupTime,"onUpdate:modelValue":a[1]||(a[1]=e=>B.nextFollowupTime=e),type:"datetime","default-time":T(I),"value-format":"YYYY-MM-DD HH:mm","time-format":"HH:mm","disabled-date":G,placeholder:"选择跟进时间"},null,8,["modelValue","default-time"])])),_:1}),b(V,{label:"跟进内容",prop:"remark",style:{width:"100%"}},{default:v((()=>[b(te,{modelValue:B.remark,"onUpdate:modelValue":a[2]||(a[2]=e=>B.remark=e),type:"textarea",autosize:{minRows:4,maxRows:8},placeholder:"填写跟进内容"},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])):g("",!0)])])),_:1}),T(k).customer_pro.clues._permission.followList?(d(),c(se,{key:0,label:"跟进记录",name:"follow"},{default:v((()=>[b(o,{"content-position":"left"},{default:v((()=>[_("进度")])),_:1}),f("div",M,[f("div",H,[U.value?(d(),c(pe,{key:0,active:U.value.length,direction:"vertical","finish-status":""},{default:v((()=>[(d(!0),y(w,null,h(U.value,((e,l)=>(d(),c(ne,{icon:T(t),style:{margin:"0 0 10px 0"},key:l},{title:v((()=>[f("h4",null,F(e.followTypeName),1)])),description:v((()=>[f("div",q,[f("p",O,F(e.remark),1),f("p",R," 下次跟进时间："+F(e.nextFollowupTime),1),f("p",L," 添加时间： "+F(e.createTime)+"「"+F(e.userName)+"」 ",1)])])),_:2},1032,["icon"])))),128))])),_:1},8,["active"])):g("",!0)])])])),_:1})):g("",!0),T(k).customer_pro.clues._permission.chatContentList?(d(),c(se,{key:1,label:"聊天记录",name:"talk"},{default:v((()=>[b(o,{"content-position":"left"},{default:v((()=>[_("聊天记录")])),_:1}),b(ue,{"tab-position":"left",style:{height:"500px"}},{default:v((()=>[(d(!0),y(w,null,h(x.value,((e,l)=>(d(),c(se,{key:l,label:`版本${e.chatContentVersion}`},{default:v((()=>[f("div",S,[e&&(null==e?void 0:e.chat_content)?(d(),c(pe,{key:0,active:oe(null==e?void 0:e.chat_content).length,direction:"vertical"},{default:v((()=>[(d(!0),y(w,null,h(oe(null==e?void 0:e.chat_content),((l,a)=>(d(),c(ne,{icon:"g"==oe(null==e?void 0:e.chat_content).msg_type?T(r):T(s),style:{margin:"0 0 10px 0"},key:a},{title:v((()=>[f("h4",null,F("g"==l.msg_type?"访客":l.worker_name),1)])),description:v((()=>{var e;return[f("div",N,[(null==(e=l.msg)?void 0:e.includes("[IMG]"))?(d(!0),y(w,{key:0},h(ae(l.msg),((e,l)=>(d(),y("div",{key:l},[f("img",{src:e,style:{width:"100px"}},null,8,P)])))),128)):(d(),y("p",z,[f("span",{innerHTML:l.msg},null,8,A)])),f("p",W,F(T(p)(l.msg_time,"YYYYMMDDHHmmss").format("YYYY-MM-DD HH:mm:ss")),1)])]})),_:2},1032,["icon"])))),128))])),_:2},1032,["active"])):g("",!0)])])),_:2},1032,["label"])))),128))])),_:1})])),_:1})):g("",!0)])),_:1},8,["modelValue"])}}}),$={style:{padding:"0 30px"}},J={key:0},X={key:1,style:{color:"#d83b01"}},Z={key:2},B={key:3},K={key:0,style:{color:"#d83b01"}},Q={key:1,style:{color:"#00b294"}},ee={style:{display:"flex","flex-direction":"row","flex-wrap":"wrap","align-items":"center",gap:"12px"}},le={class:"dialog-footer"},ae={class:"dialog-footer"},oe=u({name:"customer_pro-clues"}),te=I(u({...oe,setup(t){const{service:r}=a(),s=V(),p=V(),u=V(0),C=V(),I=V(!1),Y=V(!0),D=l.useUpsert({items:[()=>{var e;return{label:"53标识",prop:"guest_id",span:12,hidden:"add"==(null==(e=D.value)?void 0:e.mode),component:{name:"el-input",props:{disabled:!0}}}},()=>{var e;return{label:"项目",prop:"project_id",span:12,component:{name:"el-select",props:{disabled:"add"!==(null==(e=D.value)?void 0:e.mode)}}}},()=>{var e;return{label:"IP",prop:"ip",span:12,hidden:"add"==(null==(e=D.value)?void 0:e.mode),component:{name:"el-input",props:{disabled:!0}}}},()=>{var e;return{label:"IP归属地",prop:"guest_ip_info",span:12,hidden:"add"==(null==(e=D.value)?void 0:e.mode),component:{name:"el-input",props:{disabled:!0}}}},{label:"姓名",prop:"name",span:12,component:{name:"el-input"}},{label:"来源",prop:"source_from",span:12,required:!0,component:{name:"el-select"}},{label:"关键字",prop:"keywords",span:12,component:{name:"el-input"}},{label:"手机号",prop:"mobile",span:12,component:{name:"el-input"}},{label:"微信号",prop:"wechat",span:12,component:{name:"el-input"}},{label:"学历",prop:"education",span:12,component:{name:"el-select"}},{label:"毕业院校",prop:"graduated_school",span:12,component:{name:"el-input"}},{label:"意向院校",prop:"school_id",span:12,component:{name:"slot-school_id"}},{label:"意向专业",prop:"majors_id",span:12,component:{name:"slot-majors_id"}},{label:"报读类型",prop:"majors_type",span:12,component:{name:"el-select"}},{label:"报读层次",prop:"degree_id",span:12,component:{name:"el-select"}},{label:"户口类型",prop:"household_type",span:12,component:{name:"el-select"}},{label:"户籍地址",prop:"household_address",span:12,component:{name:"el-input"}},{label:"线索等级",prop:"level",span:12,component:{name:"el-select",options:[]}},{label:"性别",prop:"gender",span:12,component:{name:"el-select"}},{label:"紧急联系人电话",prop:"emergency_mobile",props:{labelWidth:"130px"},span:12,component:{name:"el-input"}},{label:"备注",prop:"remark",component:{name:"el-input",props:{type:"textarea",rows:4}}}],async onOpen(e){var l,a,o,t,s,n,p,u;de();const i=await r.customer_pro.project.list();null==(l=D.value)||l.setOptions("project_id",i.map((e=>({label:e.name,value:e.id}))));const m=await r.customer_pro.readtypes.list();null==(a=D.value)||a.setOptions("majors_type",m.map((e=>({label:e.name,value:e.id}))));const d=await r.customer_pro.readdegree.list();null==(o=D.value)||o.setOptions("degree_id",d.map((e=>({label:e.name,value:e.id})))),null==(t=D.value)||t.setOptions("household_type",[{label:"城镇",value:"1"},{label:"农村",value:"2"}]),null==(s=D.value)||s.setOptions("level",[{label:"无意向",value:"0"},{label:"无效",value:"1"},{label:"有意向",value:"2"}]),null==(n=D.value)||n.setOptions("gender",[{label:"保密",value:"0"},{label:"男",value:"1"},{label:"女",value:"2"}]),null==(p=D.value)||p.setOptions("source_from",[{label:"手动录入",value:"1"},{label:"百度",value:"2"},{label:"抖音",value:"3"},{label:"53客服",value:"4"},{label:"小红书",value:"5"}]),null==(u=D.value)||u.setOptions("education",[{label:"未知",value:"1"},{label:"初中",value:"2"},{label:"高中/中专/中技",value:"3"},{label:"大专/高技",value:"4"},{label:"本科",value:"5"}])}}),M=l.useTable({columns:[{type:"selection"},()=>({label:"#",type:"expand",prop:"detail"}),{label:"序号",prop:"id",width:100,formatter:(e,l,a,o)=>e.id>67114?e.serialId:e.id},{label:"项目",prop:"project_name"},{label:"姓名",prop:"name",width:150},{label:"手机号",prop:"mobile"},{label:"微信号",prop:"wechat"},{label:"关键词",prop:"keywords"},{label:"跟进状态",prop:"followupType",width:80,dict:[{label:"待跟进",value:"1",type:"danger"},{label:"电话访谈",value:"2",type:"warning"},{label:"微信沟通",value:"3",type:"warning"},{label:"视频参观",value:"4",type:"info"},{label:"预约参观",value:"5",type:"info"},{label:"已参观",value:"6",type:"success"}]},{label:"状态",prop:"status",width:80},{type:"op",width:160,buttons:["slot-op"]}]}),H=l.useCrud({service:r.customer_pro.clues},(e=>{e.refresh()})),q=j((()=>{var e;return null==(e=H.value)?void 0:e.selection.length})),O=j((()=>({style:{width:"200px",fontWeight:"400",float:"left",marginRight:"auto",paddingLeft:"20px"},htmlText:`已选中 ${q.value} 条`,selectNum:q.value}))),R=e=>{var l;null==(l=H.value)||l.refresh(e)},L=V(!1),S=V(!1),N=()=>{s.value.sub()},P=()=>{S.value=!1,R()},z=()=>{s.value.pushCommonClause(),R()},A=l.useForm(),W=l.useForm(),G=async()=>{var e,l,a,t;se.value=[],null==(e=W.value)||e.setForm("group_id",null),pe.value=[],null==(l=W.value)||l.setForm("services_id",null),C.value=await r.customer_pro.project.list();const s=null==(a=H.value)?void 0:a.selection.map((e=>e.id));null==(t=W.value)||t.open({title:"分配",items:[{label:"项目",prop:"project_id",component:{name:"slot-project_id"},required:!0},{label:"客服组",prop:"group_id",component:{name:"slot-group_id"},required:!0},{label:"接收人",prop:"services_id",component:{name:"slot-services_id"},required:!0}],on:{async open(){},submit(e,{done:l,close:a}){r.customer_pro.clues.distribute({ids:s,servicesId:e.services_id}).then((()=>{o.success("分配完成"),a(),R()})).catch((e=>{o.error(e.message),l()}))}}})},oe=V(),te=e=>{var l,a;se.value=[],null==(l=W.value)||l.setForm("group_id",null),pe.value=[],null==(a=W.value)||a.setForm("services_id",null),oe.value=e,ne(e)},re=e=>{var l;pe.value=[],null==(l=W.value)||l.setForm("services_id",null),ue(e,oe.value)},se=V(),ne=async e=>{se.value=await r.customer_pro.project_group.list({projectId:e})},pe=V(),ue=async(e,l)=>{pe.value=await r.customer_pro.kf.list({groupId:e,projectId:l})},ie=V(),me=V(),de=async()=>{var e;ie.value=await r.customer_pro.school.list(),"add"!=(null==(e=D.value)?void 0:e.mode)&&ve(ie.value[0].id)},ce=async e=>{var l;null==(l=A.value)||l.setForm("majors_id",null),ve(e)},ve=async e=>{me.value=await r.customer_pro.majors.list({schoolId:e})},be=new Date,_e=l.useAdvSearch({items:[{label:"线索等级",prop:"levelStatus",component:{name:"el-select",props:{clearable:!0},options:[{label:"全部",value:"-1"},{label:"无意向",value:"0"},{label:"无效",value:"1"},{label:"有意向",value:"2"}]}},{label:"来源",prop:"sourceStatus",component:{name:"el-select",props:{clearable:!0},options:[{label:"全部",value:"0"},{label:"手动录入",value:"1"},{label:"百度",value:"2"},{label:"抖音",value:"3"},{label:"53客服",value:"4"},{label:"小红书",value:"5"}]}},{label:"客服分配状态",prop:"serviceStatus",component:{name:"el-select",props:{clearable:!0},options:[{label:"全部",value:0},{label:"未分配",value:1},{label:"已分配",value:2}]}},{label:"跟进状态",prop:"followType",component:{name:"el-select",props:{clearable:!0},options:[{label:"待跟进",value:1},{label:"电话访谈",value:2},{label:"微信沟通",value:3},{label:"视频参观",value:4},{label:"预约参观",value:5},{label:"已参观",value:6}]}},{label:"时间",prop:"datetimerange",component:{name:"el-date-picker",props:{type:"datetimerange",startPlaceholder:"开始日期",endPlaceholder:"结束日期",defaultTime:be,value:"YYYY-MM-DD HH:mm",valueFormat:"YYYY-MM-DD HH:mm",timeFormat:"HH:mm"}}}],op:["reset","close","search"],onSearch(e,{next:l,close:a}){l(e),I.value=!1,I.value=Object.values(e).some((e=>{if(e)return!0}))}}),fe=V(),ge=V(!1),ye=e=>{switch(e){case"1":return"手动录入";case"2":return"百度";case"3":return"抖音";case"4":return"53客服";case"5":return"小红书"}},he=e=>{switch(e){case"0":return"无意向";case"1":return"无效";case"2":return"有意向"}},we=()=>"rowColor";return i((async()=>{await(async()=>{fe.value=await r.customer_pro.comm.person(),ge.value=fe.value.roleIds.split(",").includes("1")})()})),(l,a)=>{const t=m("cl-refresh-btn"),i=m("cl-add-btn"),j=m("cl-multi-delete-btn"),V=m("el-button"),q=m("el-popconfirm"),oe=m("cl-flex1"),ne=m("cl-adv-btn"),ue=m("cl-search-key"),ve=m("cl-row"),be=m("cl-table"),fe=m("cl-pagination"),je=m("el-option"),ke=m("el-select"),xe=m("cl-upsert"),Ve=m("cl-form"),Ce=m("cl-dialog"),Te=m("cl-adv-search"),Fe=m("cl-crud"),Ue=k("permission");return d(),c(Fe,{ref_key:"Crud",ref:H},{default:v((()=>[b(ve,null,{default:v((()=>{var l;return[b(t),b(i),b(j),b(V,{plain:"",onClick:a[0]||(a[0]=e=>(()=>{var e;Y.value=!Y.value,null==(e=M.value)||e.data.map((e=>{var l;null==(l=M.value)||l.toggleRowExpansion(e,Y.value)}))})()),style:{"margin-right":"10px"}},{default:v((()=>[_(F(Y.value?"全部收起":"全部展开"),1)])),_:1}),x((d(),c(V,{type:"warning",disabled:0==(null==(l=T(M))?void 0:l.selection.length),onClick:G},{default:v((()=>[_("分配")])),_:1},8,["disabled"])),[[Ue,T(r).customer_pro.clues._permission.distribute]]),b(q,{title:"会清空当前系统的数据，确定迁移数据吗?",onConfirm:a[1]||(a[1]=e=>(async()=>{await r.customer_pro.config.info({id:1}),r.customer_pro.config.migrateData().then((()=>{o.success("迁移执行中，请稍等5分钟再刷新页面")})).catch((e=>{o.error(e.message)}))})())},{reference:v((()=>[ge.value?(d(),c(V,{key:0,bg:"",type:"danger"},{default:v((()=>[_("迁移数据")])),_:1})):g("",!0)])),_:1}),b(q,{title:"清空当前系统全部数据吗?",onConfirm:a[2]||(a[2]=e=>(async()=>{r.customer_pro.config.clearTable().then((()=>{o.success("清除数据完成"),R()}))})())},{reference:v((()=>[ge.value?(d(),c(V,{key:0,bg:"",type:"info"},{default:v((()=>[_("清除数据")])),_:1})):g("",!0)])),_:1}),b(oe),x(b(V,{type:"info",text:"",bg:"",icon:T(n)},{default:v((()=>[_(" 正在搜索中 ")])),_:1},8,["icon"]),[[e,I.value]]),b(ne),b(ue)]})),_:1}),b(ve,null,{default:v((()=>[b(be,{ref_key:"Table",ref:M,border:!1,"default-expand-all":!0,"row-class-name":we},{"column-detail":v((({scope:e})=>{var l,a,o,t,r,s,n,p,u,i,m,c,v,b,_;return[f("div",$,[(null==(l=e.row)?void 0:l.createdName)?(d(),y("p",J,"创建者: "+F(null==(a=e.row)?void 0:a.createdName),1)):g("",!0),f("p",null,"账户: "+F(null==(o=e.row)?void 0:o.account_name),1),(null==(t=e.row)?void 0:t.services_names)?(d(),y("p",X," 分配过的客服: "+F(null==(r=e.row)?void 0:r.services_names),1)):g("",!0),f("p",null,"来源: "+F(ye(null==(s=e.row)?void 0:s.source_from)),1),(null==(n=e.row)?void 0:n.level)?(d(),y("p",Z," 线索等级: "+F(he(null==(p=e.row)?void 0:p.level)),1)):g("",!0),f("p",null,"IP归属地: "+F(null==(u=e.row)?void 0:u.guest_ip_info),1),f("p",null," 最后跟进时间: "+F((null==(i=e.row)?void 0:i.last_followup_time)?null==(m=e.row)?void 0:m.last_followup_time:null==(c=e.row)?void 0:c.createTime),1),f("p",null," 创建时间: "+F(null==(v=e.row)?void 0:v.createTime),1),(null==(b=e.row)?void 0:b.remark)?(d(),y("p",B,"备注: "+F(null==(_=e.row)?void 0:_.remark),1)):g("",!0)])]})),"column-status":v((({scope:e})=>[0==e.row.status?(d(),y("span",K," 未成交 ")):g("",!0),1==e.row.status?(d(),y("span",Q," 已成交 ")):g("",!0)])),"slot-op":v((({scope:e})=>[f("div",ee,[0==e.row.status&&T(r).customer_pro.clues._permission.update?(d(),c(V,{key:0,text:"",bg:"",type:"primary",onClick:l=>{var a,o,t;0==(a=e.row).status?null==(o=H.value)||o.rowEdit(a):null==(t=H.value)||t.rowInfo(a)}},{default:v((()=>[_("编辑")])),_:2},1032,["onClick"])):g("",!0),b(V,{text:"",bg:"",type:"info",onClick:l=>{return a=e.row,p.value=a.id,u.value=a.status,void(S.value=!0);var a}},{default:v((()=>[_("跟进")])),_:2},1032,["onClick"]),T(r).customer_pro.clues._permission.getTrackList?(d(),c(V,{key:1,text:"",bg:"",type:"warning",onClick:l=>{return a=e.row,p.value=a.id,void(L.value=!0);var a}},{default:v((()=>[_("轨迹")])),_:2},1032,["onClick"])):g("",!0),0==e.row.status&&T(r).customer_pro.order._permission.add?(d(),c(V,{key:2,text:"",bg:"",type:"success",onClick:l=>(async e=>{var l;p.value=e.id;const a=await r.customer_pro.clues.info({id:p.value});null==(l=A.value)||l.open({title:"线索成交",items:[{type:"tabs",props:{labels:[{label:"基础信息",value:"base"},{label:"个人信息",value:"person"},{label:"收款信息",value:"financial"}]}},{label:"学生名称",prop:"name",span:8,component:{name:"el-input"},required:!0,group:"base"},{label:"学生电话",prop:"mobile",span:8,component:{name:"el-input"},required:!0,group:"base"},{label:"接待人员",prop:"receiver",span:8,component:{name:"el-input"},required:!0,group:"base"},{label:"身份证",prop:"idcard_number",span:8,component:{name:"el-input"},required:!0,group:"base"},{label:"性别",prop:"gender",span:8,component:{name:"el-select",options:[{label:"保密",value:"0"},{label:"男",value:"1"},{label:"女",value:"2"}]},required:!0,group:"base"},{label:"意向院校",prop:"school_id",span:8,component:{name:"slot-school_id"}},{label:"意向专业",prop:"majors_id",span:8,component:{name:"slot-majors_id"}},{label:"报读类型",prop:"majors_type",span:8,component:{name:"el-select",options:[]},required:!0,group:"base"},{label:"报读层次",prop:"degree_id",span:8,component:{name:"el-select",options:[]},required:!0,group:"base"},{label:"通讯地址",prop:"address",span:24,component:{name:"el-input"},group:"person"},{label:"紧急联系人",prop:"emergency_contact",span:12,component:{name:"el-input"},group:"person"},{label:"紧急联系人电话",prop:"emergency_mobile",props:{labelWidth:"130px"},span:12,component:{name:"el-input"},group:"person"},{label:"微信",prop:"wechat",span:8,component:{name:"el-input"},group:"person"},{label:"民族",prop:"nation",span:8,component:{name:"el-input"},group:"person"},{label:"籍贯",prop:"native_place",span:8,component:{name:"el-input"},group:"person"},{label:"政治面貌",prop:"politics_status",span:8,component:{name:"el-input"},group:"person"},{label:"户口性质",prop:"household_type",span:8,component:{name:"el-select"},group:"person"},{label:"户口所在地",prop:"household_address",span:8,component:{name:"el-input"},group:"person"},{label:"是否应届",prop:"freshman",span:8,component:{name:"el-input"},group:"person"},{label:"当前学历",prop:"education",span:8,component:{name:"el-select"},group:"person"},{label:"毕业学校",prop:"graduated_school",span:8,component:{name:"el-input"},group:"person"},{label:"毕业时间",prop:"graduated_date",span:8,component:{name:"el-input"},group:"person"},{label:"备注",prop:"remark",span:24,component:{name:"el-input",props:{type:"textarea",rows:4}},group:"base"},{label:"校方收定位金",prop:"school_payment",span:8,value:0,component:{name:"el-input-number",props:{precision:2,step:.1}},group:"financial"},{label:"自收定位金",prop:"teams_payment",span:8,value:0,component:{name:"el-input-number",props:{precision:2,step:.1}},group:"financial"},{label:"支付编号",prop:"serial",span:8,component:{name:"el-input"},group:"financial"},{label:"缴费凭证",prop:"voucher",span:8,component:{name:"cl-upload"},group:"financial"}],form:{...a},on:{async open(){var e,l,a,o;de();const t=await r.customer_pro.readtypes.list();null==(e=A.value)||e.setOptions("majors_type",t.map((e=>({label:e.name,value:e.id}))));const s=await r.customer_pro.readdegree.list();null==(l=A.value)||l.setOptions("degree_id",s.map((e=>({label:e.name,value:e.id})))),null==(a=A.value)||a.setOptions("household_type",[{label:"城镇",value:"1"},{label:"农村",value:"2"}]),null==(o=A.value)||o.setOptions("education",[{label:"未知",value:"1"},{label:"初中",value:"2"},{label:"高中/中专/中技",value:"3"},{label:"大专/高技",value:"4"},{label:"本科",value:"5"}])},submit(l,{close:a,done:o}){l.clues_id=p.value,l.services_id=e.services_id,l.project_id=e.project_id,r.customer_pro.order.add({...l}).then((e=>{a(),R()}))}}})})(e.row)},{default:v((()=>[_("成交")])),_:2},1032,["onClick"])):g("",!0)])])),_:1},512)])),_:1}),b(ve,null,{default:v((()=>[b(oe),b(fe,{ref:"PaginationRef",slotDom:T(O)},null,8,["slotDom"])])),_:1}),b(xe,{ref_key:"Upsert",ref:D},{"slot-school_id":v((({scope:e})=>[b(ke,{modelValue:e.school_id,"onUpdate:modelValue":l=>e.school_id=l,onChange:ce},{default:v((()=>[(d(!0),y(w,null,h(ie.value,(e=>(d(),c(je,{key:e.value,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue"])])),"slot-majors_id":v((({scope:e})=>[b(ke,{modelValue:e.majors_id,"onUpdate:modelValue":l=>e.majors_id=l},{default:v((()=>[(d(!0),y(w,null,h(me.value,(e=>(d(),c(je,{key:e.value,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:1},512),b(Ve,{ref_key:"DistributeFormRef",ref:W},{"slot-project_id":v((({scope:e})=>[b(ke,{modelValue:e.project_id,"onUpdate:modelValue":l=>e.project_id=l,onChange:te},{default:v((()=>[(d(!0),y(w,null,h(C.value,(e=>(d(),c(je,{key:e.value,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue"])])),"slot-group_id":v((({scope:e})=>[b(ke,{modelValue:e.group_id,"onUpdate:modelValue":l=>e.group_id=l,onChange:re},{default:v((()=>[(d(!0),y(w,null,h(se.value,(e=>(d(),c(je,{key:e.value,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue"])])),"slot-services_id":v((({scope:e})=>[b(ke,{modelValue:e.services_id,"onUpdate:modelValue":l=>e.services_id=l},{default:v((()=>[(d(!0),y(w,null,h(pe.value,(e=>(d(),c(je,{key:e.value,label:e.name,value:e.userId},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:1},512),b(Ce,{title:"跟进",modelValue:S.value,"onUpdate:modelValue":a[4]||(a[4]=e=>S.value=e)},{footer:v((()=>[f("div",le,[b(q,{title:"确定放入公海吗?",onConfirm:z},{reference:v((()=>[0==u.value&&T(r).customer_pro.clues._permission.pushCommonClause?(d(),c(V,{key:0,type:"warning"},{default:v((()=>[_(" 放入公海 ")])),_:1})):g("",!0)])),_:1}),b(V,{onClick:a[3]||(a[3]=e=>S.value=!1)},{default:v((()=>[_("取消")])),_:1}),0==u.value&&T(r).customer_pro.clues._permission.followAdd?(d(),c(V,{key:0,type:"success",onClick:N},{default:v((()=>[_(" 保存 ")])),_:1})):g("",!0)])])),default:v((()=>[b(E,{ref_key:"FollowRef",ref:s,id:p.value,status:u.value,onCancel:P},null,8,["id","status"])])),_:1},8,["modelValue"]),b(Ce,{title:"轨迹",modelValue:L.value,"onUpdate:modelValue":a[6]||(a[6]=e=>L.value=e)},{footer:v((()=>[f("div",ae,[b(V,{onClick:a[5]||(a[5]=e=>L.value=!1)},{default:v((()=>[_("关闭")])),_:1})])])),default:v((()=>[b(U,{ref:"TrackRef",id:p.value},null,8,["id"])])),_:1},8,["modelValue"]),b(Ve,{ref_key:"OrderFormRef",ref:A},{"slot-school_id":v((({scope:e})=>[b(ke,{modelValue:e.school_id,"onUpdate:modelValue":l=>e.school_id=l,onChange:ce},{default:v((()=>[(d(!0),y(w,null,h(ie.value,(e=>(d(),c(je,{key:e.value,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue"])])),"slot-majors_id":v((({scope:e})=>[b(ke,{modelValue:e.majors_id,"onUpdate:modelValue":l=>e.majors_id=l},{default:v((()=>[(d(!0),y(w,null,h(me.value,(e=>(d(),c(je,{key:e.value,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:1},512),b(Te,{ref_key:"AdvSearch",ref:_e},null,512)])),_:1},512)}}}),[["__scopeId","data-v-e2354db0"]]);export{te as default};
