import{i as e}from"./index.umd.min-b68308bb.js";import{u as t,d as r}from"./index-c06e60a9.js";import"./vue-echarts-11c03c89.js";import{a as s,e as i}from"./element-plus-961823fe.js";import{a as o}from"./index-4d43d044.js";import{v as l}from"./@vue.runtime-dom-0c977c95.js";import"./store-52839c99.js";import{af as a}from"./@element-plus.icons-vue-15072d5d.js";import{u as n}from"./component-942ac5f4.js";import{f as p,h as d,a5 as m,a9 as c,X as u,o as v,c as j,a as f,V as b,W as h,_ as y,g,F as k,a3 as x,Z as w,aT as _,aS as C,C as W}from"./@vue.runtime-core-dd57a9c9.js";import{r as z,M as T}from"./@vue.reactivity-9aee8bf6.js";import{D as q,ak as I}from"./@vue.shared-dddd31b8.js";import{_ as F}from"./vue-qr-c4264fa6.js";import{c as R}from"./lodash-es-8394daf0.js";import"./array.prototype.flat-eee42aa4.js";import"./define-properties-b1343066.js";import"./object-keys-e5f060db.js";import"./has-property-descriptors-6845433e.js";import"./get-intrinsic-cff09dfa.js";import"./has-symbols-a48c7173.js";import"./function-bind-cd5d7d08.js";import"./has-3a5c7287.js";import"./call-bind-cfba7623.js";import"./es-abstract-253c30b8.js";import"./has-proto-93b28181.js";import"./gopd-1516b43e.js";import"./is-regex-74a42cfc.js";import"./has-tostringtag-ad4fd641.js";import"./is-callable-99eeba16.js";import"./object-inspect-66cad57c.js";import"./es-to-primitive-6664914a.js";import"./is-date-object-d2231eea.js";import"./is-symbol-3a29a1ce.js";import"./safe-regex-test-183ad494.js";import"./es-shim-unscopables-89146e87.js";import"./vue-6d1d317a.js";import"./vue-router-17136280.js";import"./monaco-editor-c28fb00f.js";import"./axios-6b2fb661.js";import"./nprogress-64657d8f.js";import"./@vueuse.core-3c960f69.js";import"./@vueuse.shared-2b88397c.js";import"./pinia-efddbf44.js";import"./vue-demi-71ba0ef2.js";import"./mockjs-0b3ee9ca.js";import"./merge-4bdec194.js";import"./mitt-2d52b530.js";import"./clone-deep-53153407.js";import"./shallow-clone-d419fbda.js";import"./kind-of-d78bf752.js";import"./is-plain-object-40c8282f.js";import"./isobject-c886ab54.js";import"./resize-detector-2312ef2b.js";import"./echarts-e550b62f.js";import"./tslib-a4e99503.js";import"./zrender-f72fb7be.js";import"./@ctrl.tinycolor-d9b9bf03.js";import"./@popperjs.core-b696b006.js";import"./dayjs-89173748.js";import"./async-validator-ff95bfc9.js";import"./memoize-one-63ab667a.js";import"./escape-html-1935ddb3.js";import"./normalize-wheel-es-3222b0a2.js";import"./@floating-ui.dom-92665be4.js";import"./@floating-ui.core-c1b3624a.js";import"./js-binary-schema-parser-814ef804.js";const V={class:"dict-group"},G={class:"head"},M=(e=>(_("data-v-cf81c5a9"),e=e(),C(),e))((()=>f("span",null,"类型",-1))),N={class:"list"},E=["onClick","onContextmenu"],S=p({name:"undefined"}),A=F(p({...S,emits:["refresh"],setup(o,{emit:p}){const{service:_}=t(),{ViewGroup:C}=n(),W=e.useForm(),F=z([]),R=z(!1);async function S(){R.value=!0,await _.dict.type.list({order:"createTime",sort:"asc"}).then((e=>{var t;F.value=e,(null==(t=C.value)?void 0:t.selected)||function(e){var t,r;e||(e=F.value[0]);e&&(p("refresh",{typeId:e.id,page:1}),null==(t=C.value)||t.select(e),null==(r=C.value)||r.setTitle(`字典列表（${e.name}）`))}()})),R.value=!1}function A(e){var t;null==(t=W.value)||t.open({title:e?"编辑类型":"添加类型",width:"500px",props:{labelWidth:"60px"},items:[{label:"名称",prop:"name",component:{name:"el-input",props:{maxlength:20}},required:!0},{label:"Key",prop:"key",component:{name:"el-input",props:{maxlength:20}},required:!0}],form:{...e},on:{submit(t,{close:r,done:i}){_.dict.type[e?"update":"add"](t).then((()=>{s.success("保存成功"),r(),S()})).catch((e=>{s.error(e.message),i()}))}}})}return d((()=>{S()})),(t,o)=>{const n=m("el-button"),p=m("el-icon"),d=m("el-empty"),z=m("el-scrollbar"),D=m("cl-form"),K=c("permission"),U=c("loading");return u((v(),j("div",V,[f("div",G,[M,u((v(),b(n,{type:"success",bg:"",size:"small",onClick:o[0]||(o[0]=e=>A())},{default:h((()=>[y("添加")])),_:1})),[[K,T(_).dict.type.permission.add]])]),f("div",N,[g(z,null,{default:h((()=>[f("ul",null,[(v(!0),j(k,null,x(F.value,((o,n)=>{var d,m,c,b;return v(),j("li",{key:n,class:q(["item",{"is-active":(null==(m=null==(d=T(C))?void 0:d.selected)?void 0:m.id)==o.id}]),onClick:e=>t.select(o),onContextmenu:t=>{!function(t,o){e.ContextMenu.open(t,{hover:{target:"item"},list:[{label:"编辑",hidden:!r(_.dict.type.permission.update),callback(e){e(),A(o)}},{label:"删除",hidden:!r(_.dict.type.permission.delete),callback(e){e(),i.confirm("是否要删除该类型？","提示",{type:"warning"}).then((()=>{_.dict.type.delete({ids:[o.id]}).then((async()=>{var e,t;s.success("删除成功"),await S(),(null==(t=null==(e=C.value)?void 0:e.selected)?void 0:t.id)==o.id&&select()})).catch((e=>{s.error(e.message)}))})).catch((()=>null))}}]})}(t,o)}},[f("span",null,I(o.name)+" - "+I(o.key),1),u(g(p,null,{default:h((()=>[g(T(a))])),_:2},1536),[[l,(null==(b=null==(c=T(C))?void 0:c.selected)?void 0:b.id)==o.id]])],42,E)})),128)),0==F.value.length?(v(),b(d,{key:0,"image-size":80})):w("",!0)])])),_:1})]),g(D,{ref_key:"Form",ref:W},null,512)])),[[U,R.value]])}}}),[["__scopeId","data-v-cf81c5a9"]]),D=p({name:"dict-list"}),K=p({...D,setup(r){const{service:s}=t(),{ViewGroup:i}=n(),l=e.useUpsert({dialog:{width:"600px"},props:{labelWidth:"100px"},items:[{label:"上级节点",prop:"parentId",component:{name:"el-tree-select",props:{data:W((()=>{var e;const t=R(null==(e=a.value)?void 0:e.data);return function e(t,r){var s;t.id&&t.id==(null==(s=l.value)?void 0:s.getForm("id"))&&(r=!0),r&&(t.disabled=!0),t.children&&t.children.forEach((t=>{e(t,r)}))}({children:t},!1),t})),props:{label:"name",value:"id",children:"children",disabled:"disabled"},clearable:!0,filterable:!0,"default-expand-all":!0,"check-strictly":!0}}},{label:"名称",prop:"name",required:!0,component:{name:"el-input"}},{label:"值",prop:"value",component:{name:"el-input"}},{label:"排序",prop:"orderNum",value:1,component:{name:"el-input-number",props:{min:1}}},{label:"备注",prop:"remark",component:{name:"el-input",props:{type:"textarea",rows:4}}}],onSubmit(e,{next:t}){var r,s;t({...e,typeId:null==(s=null==(r=i.value)?void 0:r.selected)?void 0:s.id})}}),a=e.useTable({contextMenu:["refresh",e=>{var t;return{label:"新增",hidden:!(null==(t=s.dict.info._permission)?void 0:t.add),callback(t){f(e),t()}}},"edit","delete","order-asc","order-desc"],columns:[{label:"名称",prop:"name",align:"left",minWidth:200},{label:"数值",prop:"value",align:"left",minWidth:200},{label:"排序",prop:"orderNum",sortable:"desc",width:100},{label:"备注",prop:"remark",showOverflowTooltip:!0,minWidth:150},{label:"创建时间",prop:"createTime",sortable:"custom",minWidth:160},{label:"更新时间",prop:"updateTime",sortable:"custom",minWidth:160},{type:"op",width:250,buttons:["slot-btn","edit","delete"]}]}),p=e.useCrud({service:s.dict.info,onRefresh(e,{render:t}){s.dict.info.list({...e,page:void 0,size:void 0}).then((e=>{t(o(e))}))}});function d(e){var t;null==(t=p.value)||t.refresh(e)}function j(e,t){var r;(null==t?void 0:t.property)&&e.children&&(null==(r=a.value)||r.toggleRowExpansion(e))}function f(e){var t;null==(t=p.value)||t.rowAppend({parentId:e.id,orderNum:1})}return(e,t)=>{const r=m("cl-refresh-btn"),o=m("cl-add-btn"),n=m("cl-flex1"),k=m("cl-search-key"),x=m("cl-row"),w=m("el-button"),_=m("cl-table"),C=m("cl-upsert"),W=m("cl-crud"),z=m("cl-view-group"),q=c("permission");return v(),b(z,{ref_key:"ViewGroup",ref:i},{left:h((()=>[g(A,{onRefresh:d})])),right:h((()=>[g(W,{ref_key:"Crud",ref:p},{default:h((()=>[g(x,null,{default:h((()=>{var e;return[g(r),g(o,{disabled:!(null==(e=T(i))?void 0:e.selected)},null,8,["disabled"]),g(n),g(k)]})),_:1}),g(x,null,{default:h((()=>[g(_,{ref_key:"Table",ref:a,"row-key":"id",onRowClick:j},{"slot-btn":h((({scope:e})=>[u((v(),b(w,{text:"",bg:"",type:"success",onClick:t=>f(e.row)},{default:h((()=>[y("新增")])),_:2},1032,["onClick"])),[[q,T(s).dict.info.permission.add]])])),_:1},512)])),_:1}),g(x,null,{default:h((()=>[g(n)])),_:1}),g(C,{ref_key:"Upsert",ref:l},null,512)])),_:1},512)])),_:1},512)}}});export{K as default};
