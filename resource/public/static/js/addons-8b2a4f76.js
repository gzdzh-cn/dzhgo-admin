import{i as e}from"./index.umd.min-b68308bb.js";import{u as s}from"./index-c06e60a9.js";import"./vue-echarts-11c03c89.js";import{d as t,a}from"./element-plus-961823fe.js";import"./store-52839c99.js";import"./index-4d43d044.js";import{f as l,a5 as r,o,V as i,W as p,a as n,g as u,_ as m,c as d,a3 as c,F as v,Z as b,aT as j,aS as f}from"./@vue.runtime-core-dd57a9c9.js";import{r as y,M as h}from"./@vue.reactivity-9aee8bf6.js";import{D as k,ak as _}from"./@vue.shared-dddd31b8.js";import{_ as g}from"./vue-qr-c4264fa6.js";import"./array.prototype.flat-eee42aa4.js";import"./define-properties-b1343066.js";import"./object-keys-e5f060db.js";import"./has-property-descriptors-6845433e.js";import"./get-intrinsic-cff09dfa.js";import"./has-symbols-a48c7173.js";import"./function-bind-cd5d7d08.js";import"./has-3a5c7287.js";import"./call-bind-cfba7623.js";import"./es-abstract-253c30b8.js";import"./has-proto-93b28181.js";import"./gopd-1516b43e.js";import"./is-regex-74a42cfc.js";import"./has-tostringtag-ad4fd641.js";import"./is-callable-99eeba16.js";import"./object-inspect-66cad57c.js";import"./es-to-primitive-6664914a.js";import"./is-date-object-d2231eea.js";import"./is-symbol-3a29a1ce.js";import"./safe-regex-test-183ad494.js";import"./es-shim-unscopables-89146e87.js";import"./vue-6d1d317a.js";import"./@vue.runtime-dom-0c977c95.js";import"./vue-router-17136280.js";import"./monaco-editor-c28fb00f.js";import"./axios-6b2fb661.js";import"./nprogress-64657d8f.js";import"./lodash-es-8394daf0.js";import"./@vueuse.core-3c960f69.js";import"./@vueuse.shared-2b88397c.js";import"./pinia-efddbf44.js";import"./vue-demi-71ba0ef2.js";import"./mockjs-0b3ee9ca.js";import"./merge-4bdec194.js";import"./mitt-2d52b530.js";import"./clone-deep-53153407.js";import"./shallow-clone-d419fbda.js";import"./kind-of-d78bf752.js";import"./is-plain-object-40c8282f.js";import"./isobject-c886ab54.js";import"./@element-plus.icons-vue-15072d5d.js";import"./resize-detector-2312ef2b.js";import"./echarts-e550b62f.js";import"./tslib-a4e99503.js";import"./zrender-f72fb7be.js";import"./@ctrl.tinycolor-d9b9bf03.js";import"./@popperjs.core-b696b006.js";import"./dayjs-89173748.js";import"./async-validator-ff95bfc9.js";import"./memoize-one-63ab667a.js";import"./escape-html-1935ddb3.js";import"./normalize-wheel-es-3222b0a2.js";import"./@floating-ui.dom-92665be4.js";import"./@floating-ui.core-c1b3624a.js";import"./js-binary-schema-parser-814ef804.js";const x={style:{padding:"0 10px 0px 20px",display:"flex","flex-wrap":"wrap","row-gap":"10px"}},w=n("div",{class:"divider"},null,-1),C=l({name:"addons-types"}),I=l({...C,setup(t){const{service:a}=s(),l=e.useUpsert({items:[{label:"标题",prop:"name",required:!0,component:{name:"el-input"}},{label:"备注",prop:"remark",component:{name:"el-input",props:{type:"textarea",rows:4}}},{label:"排序",prop:"orderNum",value:99,component:{name:"el-input-number",props:{min:0}},required:!0}]}),m=e.useTable({columns:[{type:"selection"},{label:"标题",prop:"name"},{label:"备注",prop:"remark",showOverflowTooltip:!0},{label:"排序",prop:"orderNum"},{type:"op",buttons:["edit","delete"]}]}),d=e.useCrud({service:a.base.sys.addonsType},(e=>{e.refresh()}));return(e,s)=>{const t=r("cl-refresh-btn"),a=r("cl-add-btn"),c=r("cl-multi-delete-btn"),v=r("cl-search-key"),b=r("cl-flex1"),j=r("cl-table"),f=r("cl-row"),y=r("cl-pagination"),h=r("cl-upsert"),k=r("cl-crud");return o(),i(k,{ref_key:"Crud",ref:d},{default:p((()=>[n("div",x,[u(t),u(a),u(c,{style:{"margin-right":"10px"}}),u(v),u(b)]),w,u(f,null,{default:p((()=>[u(j,{ref_key:"Table",ref:m,border:!1},null,512)])),_:1}),u(f,null,{default:p((()=>[u(b),u(y)])),_:1}),u(h,{ref_key:"Upsert",ref:l},null,512)])),_:1},512)}}}),U=e=>(j("data-v-0827c741"),e=e(),f(),e),S={style:{padding:"10px 10px 0px 20px",display:"flex","flex-wrap":"wrap","row-gap":"10px"}},T=U((()=>n("div",{class:"divider"},null,-1))),q={class:"fileter"},z=U((()=>n("div",{class:"filter-title"},[n("span",null,"分类：")],-1))),N={class:"filter-name"},O={class:"table-op"},V=l({name:"base-addons"}),F=g(l({...V,setup(l){const{service:j}=s(),f=y([]),g=y([]),x=e.useUpsert({items:[{label:"标题",prop:"name",required:!0,component:{name:"el-input"}},{label:"插件",prop:"menuId",required:!0,component:{name:"el-select",options:[],props:{onChange:e=>{var s;const t=g.value.find((s=>s.id==e));null==(s=x.value)||s.setForm("name",t.name)}}}},{label:"类别",prop:"typeId",required:!0,component:{name:"el-select",options:[],props:{}}},{label:"备注",prop:"remark",component:{name:"el-input",props:{type:"textarea",rows:4}}},{label:"排序",prop:"orderNum",value:99,required:!0,component:{name:"el-input-number",props:{min:0}}}],async onOpen(e){j.base.sys.menu.list({addons:!0}).then((e=>{var s;g.value=e,null==(s=x.value)||s.setOptions("menuId",e.map((e=>({label:e.name||"",value:e.id}))))})),j.base.sys.addonsType.list().then((e=>{var s;null==(s=x.value)||s.setOptions("typeId",e.map((e=>({label:e.name||"",value:e.id}))))}))}}),w=e.useTable({columns:[{type:"selection"},{label:"标题",prop:"name"},{label:"类别",prop:"typeName"},{label:"描述",prop:"remark",showOverflowTooltip:!0},{label:"排序",prop:"orderNum"},{type:"op",buttons:["slot-op"]}]}),C=e.useCrud({service:j.base.sys.addons,async onRefresh(e,{render:s}){const{list:t,pagination:a}=await j.base.sys.addons.page(e);s(t,a),f.value=await j.base.sys.addonsType.list()}},(e=>{e.refresh({typeId:D.value,type:M.value})})),U=y(!1),V=()=>{U.value=!0},F=y(),D=y(),M=y(),R=(e,s)=>{var t;s&&(F.value="hasInstall",D.value=null,M.value=s),e&&(F.value=e,D.value=e,M.value=null),s||e||(F.value=null,D.value=null,M.value=null),null==(t=C.value)||t.refresh({typeId:e,type:s})},W=(e,s)=>{j.base.sys.addons.installUpdateStatus({id:e.menuId,active:s}).then((e=>{var t;null==(t=C.value)||t.refresh(),a.success(s?"安装成功":"卸载成功")})).catch((e=>{a.error(e.message)}))},Z=(e,s)=>{j.base.sys.addons.lineUpdateStatus({id:e.menuId,active:s}).then((e=>{var t;null==(t=C.value)||t.refresh(),a.success(s?"上架成功":"下架成功")})).catch((e=>{a.error(e.message)}))};return(e,s)=>{const a=r("cl-refresh-btn"),l=r("cl-add-btn"),y=r("cl-multi-delete-btn"),g=r("cl-search-key"),D=r("cl-flex1"),M=r("el-button"),A=r("cl-row"),B=r("cl-table"),E=r("cl-pagination"),G=r("cl-upsert"),H=r("cl-crud");return o(),i(H,{ref_key:"Crud",ref:C},{default:p((()=>[n("div",S,[u(a),u(l),u(y),u(g,{style:{"margin-left":"10px"}}),u(D),u(M,{type:"success",onClick:V},{default:p((()=>[m("插件类型")])),_:1})]),T,u(A,null,{default:p((()=>[n("div",q,[z,n("div",N,[u(M,{onClick:s[0]||(s[0]=e=>R(null,null)),class:k(["f-btn",{active:!F.value}])},{default:p((()=>[m("全部")])),_:1},8,["class"]),u(M,{class:k(["f-btn",{active:"hasInstall"==F.value}]),onClick:s[1]||(s[1]=e=>R(null,"hasInstall"))},{default:p((()=>[m("已安装")])),_:1},8,["class"]),(o(!0),d(v,null,c(f.value,((e,s)=>(o(),i(M,{class:k(["f-btn",{active:F.value==e.id}]),key:s,onClick:s=>R(e.id)},{default:p((()=>[m(_(e.name),1)])),_:2},1032,["class","onClick"])))),128))])])])),_:1}),u(A,null,{default:p((()=>[u(B,{ref_key:"Table",ref:w,border:!1},{"slot-op":p((({scope:e})=>[n("div",O,[!e.row.isInstall&&h(j).base.sys.addons._permission.installUpdateStatus?(o(),i(M,{key:0,type:"warning",text:"",bg:"",onClick:s=>W(e.row,!0)},{default:p((()=>[m("安装")])),_:2},1032,["onClick"])):b("",!0),e.row.isInstall&&h(j).base.sys.addons._permission.installUpdateStatus?(o(),i(M,{key:1,type:"danger",text:"",bg:"",onClick:s=>W(e.row,!1)},{default:p((()=>[m("卸载")])),_:2},1032,["onClick"])):b("",!0),!e.row.isShow&&h(j).base.sys.addons._permission.lineUpdateStatus?(o(),i(M,{key:2,type:"info",text:"",bg:"",onClick:s=>Z(e.row,!0)},{default:p((()=>[m("上架")])),_:2},1032,["onClick"])):b("",!0),e.row.isShow&&h(j).base.sys.addons._permission.lineUpdateStatus?(o(),i(M,{key:3,type:"info",text:"",bg:"",onClick:s=>Z(e.row,!1)},{default:p((()=>[m("下架")])),_:2},1032,["onClick"])):b("",!0),h(j).base.sys.addons._permission.update?(o(),i(M,{key:4,type:"primary",text:"",bg:"",onClick:s=>{var t;return null==(t=h(x))?void 0:t.edit(e.row)}},{default:p((()=>[m("编辑")])),_:2},1032,["onClick"])):b("",!0)])])),_:1},512)])),_:1}),u(A,null,{default:p((()=>[u(D),u(E)])),_:1}),u(G,{ref_key:"Upsert",ref:x},null,512),u(h(t),{modelValue:U.value,"onUpdate:modelValue":s[2]||(s[2]=e=>U.value=e),title:"插件类型",direction:"rtl",size:"40%"},{default:p((()=>[u(I)])),_:1},8,["modelValue"])])),_:1},512)}}}),[["__scopeId","data-v-0827c741"]]);export{F as default};
